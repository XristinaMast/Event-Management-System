## Περιεχόμενα

1. [Επιπλέον Παραδοχές και Παρεκκλίσεις](#Επιπλέον-Παραδοχές-και-Παρεκκλίσεις)
2. [Χρησιμοποιούμενες Τεχνολογίες](#Χρησιμοποιούμενες-Τεχνολογίες)
3. [Περιγραφή των Αρχείων](#Περιγραφή-των-Αρχείων)
4. [Πώς Εκτελείται το Σύστημα](#Πώς-Εκτελείται-το-Σύστημα)
5. [Πώς να Χρησιμοποιήσετε το Σύστημα (με Παραδείγματα Εκτέλεσης)](#Πώς-να-Χρησιμοποιήσετε-το-Σύστημα-με-Παραδείγματα-Εκτέλεσης)
6. [Αναφορές](#Αναφορές)



## Επιπλέον Παραδοχές και Παρεκκλίσεις
- Ο διαχειριστής (admin) δημιουργείται αυτόματα όταν ξεκινά το σύστημα και δεν μπορεί να εγγραφεί όπως οι κανονικοί χρήστες. Τα στοιχεία σύνδεσης του διαχειριστή είναι:
  - **Όνομα χρήστη**: `admin`
  - **Κωδικός**: `@dm!n69%`
- Το σύστημα υποθέτει ότι τα events αποθηκεύονται σε cookies.
- Οι ημερομηνίες εκδηλώσεων συγκρίνονται χρησιμοποιώντας τη βιβλιοθήκη `datetime` της Python, εξασφαλίζοντας ότι εμφανίζονται μόνο μελλοντικές εκδηλώσεις κατά την αναζήτηση.
- Ο κωδικός πρόσβασης του διαχειριστή είναι κρυπτογραφημένος για λόγους ασφάλειας.

## Χρησιμοποιούμενες Τεχνολογίες
- **Flask**: Web framework για τη δημιουργία του REST API.
- **Flask-PyMongo**: Επέκταση για την ενσωμάτωση του Flask με το MongoDB.
- **MongoDB**: NoSQL βάση δεδομένων για την αποθήκευση χρηστών και εκδηλώσεων.
- **Werkzeug**: Παρέχει εργαλεία για την κρυπτογράφηση και ασφαλή σύγκριση κωδικών πρόσβασης.
- **Docker**: Χρησιμοποιείται για την containerization της εφαρμογής Flask και του MongoDB για εύκολη ανάπτυξη και κλιμάκωση.
- **Python 3.9**: Η γλώσσα στην οποία είναι γραμμένη η εφαρμογή.
- **pymongo**: Το native Python driver για τη σύνδεση με το MongoDB.

## Περιγραφή των Αρχείων

- **code.py**: Το κύριο αρχείο της εφαρμογής που περιέχει όλα τα API routes, συμπεριλαμβανομένων της εγγραφής χρηστών, της σύνδεσης, της δημιουργίας εκδηλώσεων κ.ά.
- **Dockerfile**: Περιέχει οδηγίες για τη δημιουργία του Docker image της εφαρμογής Flask, εγκαθιστά τις εξαρτήσεις και εκκινεί την εφαρμογή.
- **docker-compose.yaml**: Ορίζει τις υπηρεσίες (Flask και MongoDB), τις ρυθμίσεις τους και το δίκτυο. Οργανώνει την εκτέλεση πολλαπλών κοντέινερ.
- **requirements.txt**: Λίστα με τις Python εξαρτήσεις που απαιτούνται για το έργο (Flask, Flask-PyMongo, Werkzeug, pymongo).
- **/data/**: Ένας φάκελος που είναι συνδεδεμένος στο κοντέινερ του MongoDB για την αποθήκευση δεδομένων, ώστε να διασφαλίζεται η διατήρηση των δεδομένων σε περίπτωση που διαγραφεί το κοντέινερ.

## Πώς Εκτελείται το Σύστημα

###Προαπαιτούμενα
Πριν εκτελέσoυμε το σύστημα, έχουμε εγκαταστήσει τα παρακάτω:

-Docker: Το Docker σας επιτρέπει να εκτελείτε την εφαρμογή μέσα σε κοντέινερ, ώστε να μπορείτε να εκτελείτε τη βάση δεδομένων MongoDB και την εφαρμογή Flask χωρίς 
 να χρειάζεται να εγκαταστήσετε ξεχωριστά όλα τα εξαρτήματα.
-Docker Compose: Σας επιτρέπει να εκκινήσετε πολλές υπηρεσίες (Flask, MongoDB) ταυτόχρονα και να τις διαχειριστείτε μέσω του `docker-compose.yaml`.

### Βήματα Εκτέλεσης

1. **Κλωνοποίηση του Repository**: Αρχικά, θα χρειαστεί να κατεβάσουμε τα αρχεία του έργου από το GitHub ή τον αποθηκευτικό χώρο όπου βρίσκονται. Εκτελούμε την ακόλουθη εντολή για την κλωνοποιήση του repository:
   ```bash
   git clone https://github.com/XristinaMast/YpoxreotikiErgasia24_E20095_Mastoraki_Xristina-Eleni
   cd your-repository
   ```
   Η εντολή αυτή δημιουργεί ένα τοπικό αντίγραφο του έργου και μας μεταφέρει στον κατάλληλο φάκελο όπου βρίσκεται το αρχείο `docker-compose.yaml`.

2. **Δημιουργία και Εκκίνηση της Εφαρμογής**: 
  Το docker-compose χρησιμοποιείται για να εκκινήσει τόσο την εφαρμογή Flask όσο και το MongoDB μέσα σε ξεχωριστά κοντέινερ. Αφού βεβαιωθούμε ότι βρισκόμαστε στον κατάλληλο φάκελο, εκτελούμε την ακόλουθη εντολή:
   ```bash
   docker-compose up
   ```
  Τι συμβαίνει όταν εκτελέσουμε την παραπάνω εντολή:
  -MongoDB κοντέινερ: Ένα κοντέινερ με το MongoDB εκκινείται, και η βάση δεδομένων είναι προσβάσιμη στη θύρα 27017. Ένα volume (./data:/data/db) διασφαλίζει ότι τα δεδομένα θα αποθηκεύονται στον τοπικό σας δίσκο και όχι 
   μόνο μέσα στο κοντέινερ.
  - Flask κοντέινερ: Ένα κοντέινερ με το Python Flask API εκκινείται στη θύρα 5000, και επικοινωνεί με το MongoDB μέσω της διεύθυνσης mongodb://mongodb:27017/HospitalDB.
  Αν όλα τα κοντέινερ ξεκινήσουν με επιτυχία, θα δείτε κάτι σαν το παρακάτω στο terminal σας:

  ```bash
  Starting mongodb ... done
  Starting flask ... done
  flask |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
  ```
   
3. **Πρόσβαση στην Εφαρμογή**:
   Για να επιβεβαιώσουμε ότι η εφαρμογή εκτελείται σωστά, ανοίγουμε έναν browser και πληκτρολογούμε τη διεύθυνση:
   ```
   http://localhost:5000
   ```

4. **Σταμάτημα του Συστήματος**:
   Για να σταματήσετε τα κοντέινερ, πατήστε `Ctrl + C` στο terminal και στη συνέχεια εκτελέστε:
   ```bash
   docker-compose down
   ```
  Αυτή η εντολή θα σταματήσει και θα απομακρύνει τα κοντέινερ, αλλά τα δεδομένα στη βάση δεδομένων θα διατηρηθούν στο φάκελο ./data.
  
### Διατήρηση Δεδομένων
Ο φάκελος `./data` που δημιουργείται στον τοπικό δίσκο είναι συνδεδεμένος με το κοντέινερ της βάσης δεδομένων MongoDB. Αυτό σημαίνει ότι ακόμα κι αν διαγράψουμε το κοντέινερ, τα δεδομένα δεν θα χαθούν.

## Πώς να Χρησιμοποιήσετε το Σύστημα (με Παραδείγματα Εκτέλεσης)

Ακολουθούν οι λεπτομέρειες για την αλληλεπίδραση με το σύστημα μέσω των API endpoints. Μπορείτε να χρησιμοποιήσετε εργαλεία όπως το **Postman** ή το **cURL** για να στείλετε αιτήματα.

### 1. **Εγγραφή Διαχειριστή (Προκαθορισμένος Admin)**
   - Ο διαχειριστής δημιουργείται αυτόματα κατά την εκκίνηση του συστήματος και δεν χρειάζεται να εγγραφεί μέσω του API.

   - Διαπιστευτήρια:
     - Όνομα χρήστη: `admin`
     - Κωδικός: `@dm!n69%`

### 2. **Εγγραφή Χρήστη**
  Κάθε νέος χρήστης μπορεί να εγγραφεί στο σύστημα με ένα αίτημα POST στο endpoint /register. Το API δέχεται ένα JSON αντικείμενο που περιλαμβάνει τα στοιχεία του χρήστη.
   - **Διεύθυνση**: `/register`
   - **Μέθοδος**: `POST`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X POST http://localhost:5000/register \
     -H "Content-Type: application/json" \
     -d '{
       "first_name": "John",
       "last_name": "Doe",
       "email": "john@gmail.com",
       "username": "john123",
       "password": "mypassword"
     }'
     ```
   - **Αναμενόμενη Απόκριση**:
     - 201: "User registered successfully!"
     - 409: "Username or Email already exists!"

### 3. **Σύνδεση Χρήστη**
  Αφού εγγραφεί ένας χρήστης, μπορεί να συνδεθεί στο σύστημα για να αποκτήσει πρόσβαση σε λειτουργίες όπως η δημιουργία και διαχείριση εκδηλώσεων.
   - **Διεύθυνση**: `/login`
   - **Μέθοδος**: `POST`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X POST http://localhost:5000/login \
     -H "Content-Type: application/json" \
     -d '{
       "username": "john123",
       "password": "mypassword"
     }'
     ```
   - **Αναμενόμενη Απόκριση**:
     - 200: "Login successful!"
     - 401: "Invalid username or password!"
Μετά τη σύνδεση, μπορούμε να χρησιμοποιήσουμε το session cookie για να κάνουμε άλλες ενέργειες (δημιουργία εκδηλώσεων, προβολή εκδηλώσεων κλπ.).

### 4. **Δημιουργία Εκδήλωσης**
  Οι χρήστες μπορούν να δημιουργήσουν εκδηλώσεις μετά τη σύνδεσή τους. Οι εκδηλώσεις αυτές θα είναι διαθέσιμες για προβολή και αναζήτηση από άλλους χρήστες.
   - **Διεύθυνση**: `/events`
   - **Μέθοδος**: `POST`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X POST http://localhost:5000/events \
     -H "Content-Type: application/json" \
     -b cookie.txt \
     -d '{
       "event_title": "Tech Conference",
       "event_description": "A conference on tech trends",
       "event_date": "2024-10-10",
       "event_hour": "10:00",
       "event_placement": "New York",
       "event_type": "conference"
     }'
     ```
   - **Αναμενόμενη Απόκριση**:
     - 201: "Event created successfully!"
     - 403: "Please log in first!" (εάν ο χρήστης δεν είναι συνδεδεμένος)

### 5. **Προβολή Όλων των Εκδηλώσεων**
Οι χρήστες μπορούν να δουν όλες τις μελλοντικές εκδηλώσεις που είναι καταχωρημένες στο σύστημα με ένα αίτημα GET στο endpoint `/events`.
   - **Διεύθυνση**: `/events`
   - **Μέθοδος**: `GET`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X GET http://localhost:5000/events -b cookie.txt
     ```
   - **Αναμενόμενη Απόκριση**:
     Μια λίστα με όλες τις μελλοντικές εκδηλώσεις σε μορφή JSON.

     **Παράδειγμα απόκρισης:**
        ```jason
        [
          {
            "_id": "614c0e7e6f8b4c35b048c123",
            "event_title": "Tech Conference",
            "event_description": "A conference on tech trends",
            "event_date": "2024-10-10",
            "event_hour": "10:00",
            "event_placement": "New York",
            "event_type": "conference"
          }
      ]
    ```

### 6. **Ενημέρωση Εκδήλωσης**
Ο δημιουργός μιας εκδήλωσης μπορεί να την ενημερώσει χρησιμοποιώντας το endpoint `/events/<id>`. Η ενημέρωση αφορά τα πεδία όπως ο τίτλος, η περιγραφή, η ημερομηνία κ.λπ.
   - **Διεύθυνση**: `/events/<id>`
   - **Μέθοδος**: `PUT`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X PUT http://localhost:5000/events/614c0e7e6f8b4c35b048c123 \
     -H "Content-Type: application/json" \
     -b cookie.txt \
     -d '{
       "event_title": "Updated Tech Conference",
       "event_description": "An updated conference description",
       "event_date": "2024-10-15",
       "event_hour": "11:00",
       "event_placement": "San Francisco",
       "event_type": "conference"
     }'
     ```
   - **Αναμενόμενη Απόκριση**:
     - 200: "Event updated successfully!"
     - 403: "Please log in first!"

### 7. **Διαγραφή Εκδήλωσης**
Οι διαχειριστές και οι δημιουργοί μιας εκδήλωσης μπορούν να τη διαγράψουν χρησιμοποιώντας το endpoint /events/<id>.
   - **Διεύθυνση**: `/events/<id>`
   - **Μέθοδος**: `DELETE`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X DELETE http://localhost:5000/events/614c0e7e6f8b4c35b048c123 -b cookie.txt
     ```
   - **Αναμενόμενη Απόκριση**:
     - 200: "Event deleted successfully!"
     - 403: "Unauthorized action!"

### 8. **Αναζήτηση Εκδηλώσεων**
Οι χρήστες μπορούν να αναζητήσουν εκδηλώσεις βάσει του τίτλου, του τύπου ή του μέρους όπου θα λάβουν χώρα, χρησιμοποιώντας το endpoint `/search`.
   - **Διεύθυνση**: `/search`
   - **Μέθοδος**: `GET`
   - **Παράδειγμα Αιτήματος**:
     ```bash
     curl -X GET "http://localhost:5000/search?event_title=Tech&event_type=conference" -b cookie.txt
     ```
   - **Αναμενόμενη Απόκριση**:
     Μια λίστα με εκδηλώσεις που ταιριάζουν με τα κριτήρια αναζήτησης σε μορφή JSON.

## Αναφορές
https://github.com/karamolegkos/Information-Systems-Lab/tree/master
